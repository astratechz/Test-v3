<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Live Player</title>

  <!-- Shaka Player -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.7/shaka-player.ui.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.7/controls.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    /* (All of your previous styling retained, slightly trimmed for brevity) */
    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html,body{height:100%; background:#000; color:#fff; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,sans-serif;}
    .mobile-container{min-height:100vh; padding-bottom:env(safe-area-inset-bottom,0);}
    .mobile-header{background:linear-gradient(135deg,#ff0000,#cc0000); padding:12px 16px; position:sticky; top:0; z-index:100; box-shadow:0 2px 10px rgba(0,0,0,.3);}
    .channel-info{display:flex; align-items:center; gap:12px;}
    .channel-logo{width:40px; height:40px; background:rgba(255,255,255,.12); border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:700;}
    .channel-text h1{font-size:1.1rem; font-weight:700;}
    .channel-text .status{font-size:.8rem; opacity:.9;}
    .status-bar{display:flex; gap:8px; padding:10px 16px; background:#111; overflow-x:auto;}
    .status-item{display:flex; align-items:center; gap:6px; padding:6px 12px; background:#222; border-radius:20px; font-size:.75rem;}
    .status-dot{width:8px; height:8px; border-radius:50%; background:#dc3545;}
    .status-dot.active{background:#28a745; animation:pulse 2s infinite;}
    @keyframes pulse{0%{opacity:1}50%{opacity:.5}100%{opacity:1}}
    .video-section{position:relative; background:#000;}
    #videoPlayer{width:100%; display:block; aspect-ratio:16/9; background:#000;}
    .loading-overlay{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.75); z-index:10; display:none;}
    .loading-spinner{width:40px; height:40px; border:3px solid rgba(255,255,255,.2); border-top:3px solid #007bff; border-radius:50%; animation:spin 1s linear infinite;}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .controls-grid{display:grid; grid-template-columns:repeat(3,1fr); gap:8px; padding:12px 16px; background:#111;}
    .control-btn{display:flex;flex-direction:column;align-items:center;gap:6px;padding:12px 8px;background:#222;border-radius:12px;color:#fff;border:0;cursor:pointer;min-height:60px;}
    .control-btn:active{transform:scale(.97)}
    .btn-primary{background:#007bff}
    .btn-success{background:#28a745}
    .btn-warning{background:#ffc107;color:#000}
    .btn-danger{background:#dc3545}
    .tabs-container{background:#111;border-top:1px solid #222;}
    .tabs{display:flex; overflow-x:auto; -webkit-overflow-scrolling:touch; padding:0 16px;}
    .tab{padding:12px 16px; background:none; border:0; color:#888; font-size:.85rem; cursor:pointer; white-space:nowrap; border-bottom:2px solid transparent;}
    .tab.active{color:#007bff; border-bottom-color:#007bff}
    .tab-content{display:none; padding:16px}
    .tab-content.active{display:block}
    .info-card{background:#111;border-radius:12px;padding:16px;border-left:4px solid #007bff}
    .channels-grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(110px,1fr)); gap:12px;}
    .channel-card{background:#0f0f0f;padding:10px;border-radius:10px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;border:1px solid #222;transition:transform .12s}
    .channel-card:hover{transform:translateY(-4px)}
    .channel-thumb{width:72px;height:48px;background:linear-gradient(180deg,#222,#111);border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:700}
    .channel-name{font-size:.85rem;color:#ddd;text-align:center}
    .debug-panel{background:#111;margin:16px;border-radius:12px;overflow:hidden;border:1px solid #222;display:none}
    .debug-header{padding:12px 16px;background:#121212;display:flex;justify-content:space-between;align-items:center}
    .debug-btn{padding:6px 12px;background:#222;border-radius:6px;border:0;color:#fff;cursor:pointer}
    .log-container{height:150px;overflow:auto;padding:12px;background:#000;font-family:monospace;font-size:.7rem}
    @media(min-width:768px){.controls-grid{grid-template-columns:repeat(6,1fr)}}
  </style>
</head>

<body>
  <div class="mobile-container">
    <!-- Header -->
    <div class="mobile-header">
      <div class="channel-info">
        <div class="channel-logo" id="headerLogo"><i class="fas fa-tv"></i></div>
        <div class="channel-text">
          <h1 id="headerTitle">Live Channel</h1>
          <div class="status">Auto-Refresh â€¢ DASH Stream</div>
        </div>
      </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
      <div class="status-item"><div class="status-dot" id="statusApi"></div><span>API</span></div>
      <div class="status-item"><div class="status-dot" id="statusPlayer"></div><span>Player</span></div>
      <div class="status-item"><div class="status-dot" id="statusDrm"></div><span>DRM</span></div>
      <div class="status-item"><div class="status-dot" id="statusRefresh"></div><span>Auto-Refresh</span></div>
      <div class="status-item"><div class="status-dot" id="statusStream"></div><span>Stream</span></div>
    </div>

    <!-- Video -->
    <div class="video-section">
      <video id="videoPlayer" crossorigin="anonymous" playsinline webkit-playsinline poster="" src=""></video>
      <div class="loading-overlay" id="playerLoading">
        <div>
          <div class="loading-spinner"></div>
          <div style="text-align:center;margin-top:8px;color:#ccc" id="loadingText">Buffering...</div>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls-grid">
      <button class="control-btn btn-primary" onclick="playVideo()"><i class="fas fa-play"></i><span>Play</span></button>
      <button class="control-btn btn-primary" onclick="pauseVideo()"><i class="fas fa-pause"></i><span>Pause</span></button>
      <button class="control-btn btn-success" onclick="refreshStream()"><i class="fas fa-sync-alt"></i><span>Refresh</span></button>
      <button class="control-btn btn-warning" onclick="toggleDebug()"><i class="fas fa-bug"></i><span>Debug</span></button>
      <button class="control-btn btn-danger" onclick="resetPlayer()"><i class="fas fa-redo"></i><span>Reset</span></button>
      <button class="control-btn" onclick="toggleFullscreen()"><i class="fas fa-expand"></i><span>Fullscreen</span></button>
    </div>

    <!-- Tabs -->
    <div class="tabs-container">
      <div class="tabs">
        <button class="tab active" onclick="switchTab('channels-tab', event)"> <i class="fas fa-tv"></i> Channels</button>
        <button class="tab" onclick="switchTab('refresh-tab', event)"> <i class="fas fa-clock"></i> Refresh</button>
        <button class="tab" onclick="switchTab('technical-tab', event)"> <i class="fas fa-cog"></i> Technical</button>
      </div>
    </div>

    <!-- Tab contents -->
    <div class="tab-content active" id="channels-tab">
      <div class="info-card">
        <h3><i class="fas fa-list"></i> Channels</h3>
        <div class="channels-grid" id="channelsGrid">
          <!-- Filled by player.js -->
        </div>
      </div>
    </div>

    <div class="tab-content" id="refresh-tab">
      <div class="info-card">
        <h3><i class="fas fa-sync-alt"></i> Refresh Information</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <div style="background:#0f0f0f;padding:10px;border-radius:8px;text-align:center">
            <div id="lastUpdate" style="font-weight:700;color:#28a745">--:--:--</div>
            <div style="font-size:.75rem;color:#ccc;margin-top:6px">Last Update</div>
          </div>
          <div style="background:#0f0f0f;padding:10px;border-radius:8px;text-align:center">
            <div id="nextRefresh" style="font-weight:700;color:#28a745">--:--:--</div>
            <div style="font-size:.75rem;color:#ccc;margin-top:6px">Next Refresh</div>
          </div>
        </div>

        <div style="margin-top:12px" class="info-item">
          <div style="font-weight:600;color:#ccc">Refresh Interval</div>
          <div style="font-family:monospace;color:#fff;margin-top:6px" id="refreshIntervalLabel">300 seconds (5 minutes)</div>
        </div>
        <div style="margin-top:8px" class="info-item">
          <div style="font-weight:600;color:#ccc">API Status</div>
          <div style="font-family:monospace;color:#fff;margin-top:6px" id="apiStatus">Unknown</div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="technical-tab">
      <div class="info-card">
        <h3><i class="fas fa-microchip"></i> Technical</h3>
        <div style="margin-bottom:10px">
          <div style="font-weight:600;color:#ccc">Player Engine</div>
          <div style="font-family:monospace;color:#fff;margin-top:6px">Shaka Player 4.3.7</div>
        </div>
        <div>
          <div style="font-weight:600;color:#ccc">Selected Channel</div>
          <div style="font-family:monospace;color:#fff;margin-top:6px" id="technicalChannel">None</div>
        </div>
      </div>
    </div>

    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
      <div class="debug-header">
        <h3><i class="fas fa-terminal"></i> Debug Console</h3>
        <div>
          <button class="debug-btn" onclick="clearLog()">Clear</button>
          <button class="debug-btn" onclick="toggleDebug()">Close</button>
        </div>
      </div>
      <div class="log-container" id="debugLog"></div>
    </div>
  </div>

  <!-- Player script (external) -->
  <script src="app.js"></script>
</body>
</html>
